# Winit

Winit := Window initialization.

Crate in charge of creating windows and polling events.

## Core ideas

### Event polling

```rust
// struct that can receive events
struct App { .. }
impl ApplicationHandler for App { .. }

fn main() {
    let mut app = App::new();

    // poll event and forward them to `app`
    let event_loop = EventLoop::new();
    event_loop.run_app(&mut app);
}

--------- inside run_app (pseudocode) ----------------- 

fn run_app(&self, app: &mut impl ApplicationHandler) {
    loop {
        let event = poll_from_os();
        app.window_event(event);
    }
}
```

- `EventLoop` :
    - Can create `Window` once running.
    - Poll events from OS.
    - Forward events to its `run_app(..)` argument.

- `ApplicationHandler` (trait) :
    - Receive events from an `EventLoop`.
    - Different receiving methods :
        - `window_event(..)`.
        - `resumed(..)`
        - Etc.

### Window creation

```rust
struct App { window: Option<Window> }

impl ApplicationHandler for App { 
    fn resumed(&mut self, event_loop) {
        // window is created here
        self.window = Some(event_loop.create_window());
    }
}

fn main() {
    // window can't be created here
    let mut app = App { window: None };
    ..
    event_loop.run_app(&mut app); // -> will call `resumed(..)`
}
```

- `Window` :
    - Must be created from a running event loop (usually inside `resumed(..)`).
    - Force App to initialize its window *later*.

## Main items

### `EventLoop`

- More important and complex than `Window`.

- Can forward custom events emitted us :
    - They are called `UserEvent`.
    - They can be send via an `EventLoopProxy`.

### `Window`

- Created from an active event loop :
    - Event loop receives the events generated by window.
    - "Active" means event loop is running (usually in `ApplicationHandler::resumed(..)`)

### `ApplicationHandler`

- `resumed(..)` :
    - Called when the system is "ready" (Recommended to create window from there).
    - Consistent : Always emitted even when there is no resume/suspend lifecycle.
    - Might be called several times back-to-back (emitted from different sources).
- `exiting(..)` :
    - Called (consistent too) before exiting the event loop.

